/** 
* @license ng-slider - v0.1.4
* (c) 2013 Julien VALERY https://github.com/darul75/ng-slider
* License: MIT 
**/
!function(a){"use strict";a.module("ngSlider",["ngSanitize"]).directive("slider",["$timeout",function(a){return{restrict:"AE",require:"?ngModel",scope:{options:"="},priority:1,template:'<span ng-class="mainSliderClass" id="{{sliderTmplId}}"><table><tr><td><div class="jslider-bg"><i class="l"></i><i class="f"></i><i class="r"></i></div><div class="jslider-pointer"></div><div class="jslider-pointer jslider-pointer-to"></div><div class="jslider-label"><span ng-bind-html="from"></span></div><div class="jslider-label jslider-label-to"><span ng-bind-html="to"></span>{{options.dimension}}</div><div class="jslider-value"><span></span>{{options.dimension}}</div><div class="jslider-value jslider-value-to"><span></span>{{options.dimension}}</div><div class="jslider-scale" id="{{sliderScaleDivTmplId}}"></div></td></tr></table></span>',link:function(b,c,d,e){e&&(b.sliderTmplId=d.id+"-slider-span",b.sliderScaleDivTmplId=d.id+"-slider-scale",b.mainSliderClass="jslider",b.mainSliderClass+=" jslider_round",e.$render=function(){(e.$viewValue||0===e.$viewValue)&&("number"==typeof e.$viewValue&&(e.$viewValue=""+e.$viewValue),e.$viewValue.split(";")[1]||(b.mainSliderClass+=" jslider-single"),b.init())},b.init=function(){b.from=""+b.options.from,b.to=""+b.options.to;var c={from:b.options.from,to:b.options.to,step:b.options.step,smooth:b.options.smooth,limits:!0,round:b.options.round||!1,value:e.$viewValue,dimension:"",scale:b.options.scale,sliderSpanId:b.sliderTmplId,callback:function(a){b.$apply(function(){e.$setViewValue(a)})}};b.options.calculate&&(c.calculate=b.options.calculate),b.options.onstatechange&&(c.onstatechange=b.options.onstatechange),a(function(){$("#"+d.id).slider(c),$("#"+b.sliderScaleDivTmplId).html(b.generateScale()),b.drawScale()})},b.generateScale=function(){if(b.options.scale&&b.options.scale.length>0){for(var a="",c=b.options.scale,d=Math.round(100/(c.length-1)*10)/10,e=0;e<c.length;e++)a+='<span style="left: '+e*d+'%">'+("|"!=c[e]?"<ins>"+c[e]+"</ins>":"")+"</span>";return a}return""},b.drawScale=function(){$("#"+d.id+"-slider-span").find(".jslider-scale span ins").each(function(){$(this).css({marginLeft:-$(this).outerWidth()/2})})},b.$watch("options",function(){b.init()}))}}}]),function(a){function b(a){return"undefined"==typeof a?!1:a instanceof Array||!(a instanceof Object)&&"[object Array]"==Object.prototype.toString.call(a)||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice")?!0:!1}function c(){return this.init.apply(this,arguments)}function d(){this._init.apply(this,arguments)}function e(){d.apply(this,arguments)}var f={settings:{from:1,to:40,step:1,smooth:!0,limits:!0,value:"3",dimension:""},className:"jslider",selector:".jslider-"};a.slider=function(b,d){var e=a(b);return e.data("jslider")&&e.data("jslider").getValue()===d.value||e.data("jslider",new c(b,d)),e.data("jslider")},a.fn.slider=function(c,d){function e(a){return void 0!==a}function f(a){return e(a)&&null!==a}var g,h=arguments;return this.each(function(){var i=a.slider(this,c);if("string"==typeof c){var j;switch(c){case"value":e(h[1])&&e(h[2])?(j=i.getPointers(),f(j[0])&&f(h[1])&&(j[0].set(h[1]),j[0].setIndexOver()),f(j[1])&&f(h[2])&&(j[1].set(h[2]),j[1].setIndexOver())):e(h[1])?(j=i.getPointers(),f(j[0])&&f(h[1])&&(j[0].set(h[1]),j[0].setIndexOver())):g=i.getValue();break;case"prc":e(h[1])&&e(h[2])?(j=i.getPointers(),f(j[0])&&f(h[1])&&(j[0]._set(h[1]),j[0].setIndexOver()),f(j[1])&&f(h[2])&&(j[1]._set(h[2]),j[1].setIndexOver())):e(h[1])?(j=i.getPointers(),f(j[0])&&f(h[1])&&(j[0]._set(h[1]),j[0].setIndexOver())):g=i.getPrcValue();break;case"calculatedValue":var k=i.getValue().split(";");g="";for(var l=0;l<k.length;l++)g+=(l>0?";":"")+i.nice(k[l]);break;case"skin":i.setSkin(h[1])}}else c||d||(b(g)||(g=[]),g.push(i))}),b(g)&&1==g.length&&(g=g[0]),g||this},c.prototype.init=function(b,c){this.settings=a.extend(!0,{},f.settings,c?c:{}),this.inputNode=a(b).hide(),this.settings.interval=this.settings.to-this.settings.from,this.settings.calculate&&a.isFunction(this.settings.calculate)&&(this.nice=this.settings.calculate),this.settings.onstatechange&&a.isFunction(this.settings.onstatechange)&&(this.onstatechange=this.settings.onstatechange),this.is={init:!1},this.o={},this.create()},c.prototype.create=function(){var b=this;this.domNode=a("#"+this.settings.sliderSpanId),this.inputNode.after(this.domNode),this.sizes={domWidth:this.domNode.width(),domOffset:this.domNode.offset()},a.extend(this.o,{pointers:{},labels:{0:{o:this.domNode.find(f.selector+"value").not(f.selector+"value-to")},1:{o:this.domNode.find(f.selector+"value").filter(f.selector+"value-to")}},limits:{0:this.domNode.find(f.selector+"label").not(f.selector+"label-to"),1:this.domNode.find(f.selector+"label").filter(f.selector+"label-to")}}),a.extend(this.o.labels[0],{value:this.o.labels[0].o.find("span")}),a.extend(this.o.labels[1],{value:this.o.labels[1].o.find("span")}),b.settings.value.split(";")[1]||(this.settings.single=!0);this.domNode.find(f.selector+"pointer").each(function(a){var c=b.settings.value.split(";")[a];if(c){b.o.pointers[a]=new e(this,a,b);var d=b.settings.value.split(";")[a-1];d&&parseInt(c,10)<parseInt(d,10)&&(c=d);var f=c<b.settings.from?b.settings.from:c;f=c>b.settings.to?b.settings.to:c,b.o.pointers[a].set(f,!0),0===a&&b.domNode.mousedown(function(c){return b.o.pointers[a]._parent={offset:b.domNode.offset(),width:b.domNode.width()},b.o.pointers[a]._mousemove(c),b.o.pointers[a].onmouseup(),!1})}}),this.o.value=this.domNode.find(".v"),this.is.init=!0,a.each(this.o.pointers,function(){b.redraw(this)}),function(b){a(window).resize(function(){b.onresize()})}(this)},c.prototype.nice=function(a){return a},c.prototype.onstatechange=function(){},c.prototype.limits=function(a,b){if(!this.settings.smooth){var c=100*this.settings.step/this.settings.interval;a=Math.round(a/c)*c}var d=this.o.pointers[1-b.uid];return d&&b.uid&&a<d.value.prc&&(a=d.value.prc),d&&!b.uid&&a>d.value.prc&&(a=d.value.prc),0>a&&(a=0),a>100&&(a=100),Math.round(10*a)/10},c.prototype.setPointersIndex=function(){a.each(this.getPointers(),function(a){this.index(a)})},c.prototype.getPointers=function(){return this.o.pointers},c.prototype.onresize=function(){var b=this;this.sizes={domWidth:this.domNode.width(),domOffset:this.domNode.offset()},a.each(this.o.pointers,function(){b.redraw(this)})},c.prototype.update=function(){this.onresize(),this.drawScale()},c.prototype.drawScale=function(){this.domNode.find(f.selector+"scale span ins").each(function(){a(this).css({marginLeft:-a(this).outerWidth()/2})})},c.prototype.redraw=function(a){return this.is.init?(this.setValue(),this.o.pointers[0]&&this.o.pointers[1]&&this.o.value.css({left:this.o.pointers[0].value.prc+"%",width:this.o.pointers[1].value.prc-this.o.pointers[0].value.prc+"%"}),this.o.labels[a.uid].value.html(this.nice(a.value.origin)),void this.redrawLabels(a)):!1},c.prototype.redrawLabels=function(a){function b(a,b,d){b.margin=-b.label/2;var e=b.border+b.margin;return 0>e&&(b.margin-=e),b.border+b.label/2>c.sizes.domWidth?(b.margin=0,b.right=!0):b.right=!1,a.o.css({left:d+"%",marginLeft:b.margin,right:"auto"}),b.right&&a.o.css({left:"auto",right:0}),b}var c=this,d=this.o.labels[a.uid],e=a.value.prc,f={label:d.o.outerWidth(),right:!1,border:e*this.sizes.domWidth/100},g=null;if(!this.settings.single){var h=this.o.pointers[1-a.uid];switch(g=this.o.labels[h.uid],a.uid){case 0:f.border+f.label/2>g.o.offset().left-this.sizes.domOffset.left?(g.o.css({visibility:"hidden"}),g.value.html(this.nice(h.value.origin)),d.o.css({visibility:"visible"}),e=(h.value.prc-e)/2+e,h.value.prc!=a.value.prc&&(d.value.html(this.nice(a.value.origin)+"&nbsp;&ndash;&nbsp;"+this.nice(h.value.origin)),f.label=d.o.outerWidth(),f.border=e*this.sizes.domWidth/100)):g.o.css({visibility:"visible"});break;case 1:f.border-f.label/2<g.o.offset().left-this.sizes.domOffset.left+g.o.outerWidth()?(g.o.css({visibility:"hidden"}),g.value.html(this.nice(h.value.origin)),d.o.css({visibility:"visible"}),e=(e-h.value.prc)/2+h.value.prc,h.value.prc!=a.value.prc&&(d.value.html(this.nice(h.value.origin)+"&nbsp;&ndash;&nbsp;"+this.nice(a.value.origin)),f.label=d.o.outerWidth(),f.border=e*this.sizes.domWidth/100)):g.o.css({visibility:"visible"})}}f=b(d,f,e),g&&(f={label:g.o.outerWidth(),right:!1,border:h.value.prc*this.sizes.domWidth/100},f=b(g,f,h.value.prc)),this.redrawLimits()},c.prototype.redrawLimits=function(){if(this.settings.limits){var a=[!0,!0];for(var b in this.o.pointers)if(!this.settings.single||0===b){var c=this.o.pointers[b],d=this.o.labels[c.uid],e=d.o.offset().left-this.sizes.domOffset.left,f=this.o.limits[0];e<f.outerWidth()&&(a[0]=!1),f=this.o.limits[1],e+d.o.outerWidth()>this.sizes.domWidth-f.outerWidth()&&(a[1]=!1)}for(var g=0;g<a.length;g++)a[g]?this.o.limits[g].fadeIn("fast"):this.o.limits[g].fadeOut("fast")}},c.prototype.setValue=function(){var a=this.getValue();this.inputNode.attr("value",a),this.onstatechange.call(this,a)},c.prototype.getValue=function(){if(!this.is.init)return!1;var b=this,c="";return a.each(this.o.pointers,function(a){void 0===this.value.prc||isNaN(this.value.prc)||(c+=(a>0?";":"")+b.prcToValue(this.value.prc))}),c},c.prototype.getPrcValue=function(){if(!this.is.init)return!1;var b="";return a.each(this.o.pointers,function(a){void 0===this.value.prc||isNaN(this.value.prc)||(b+=(a>0?";":"")+this.value.prc)}),b},c.prototype.prcToValue=function(a){var b;if(this.settings.heterogeneity&&this.settings.heterogeneity.length>0)for(var c=this.settings.heterogeneity,d=0,e=this.settings.from,f=0;f<=c.length;f++){var g;g=c[f]?c[f].split("/"):[100,this.settings.to],a>=d&&a<=g[0]&&(b=e+(a-d)*(g[1]-e)/(g[0]-d)),d=g[0],e=g[1]}else b=this.settings.from+a*this.settings.interval/100;return this.round(b)},c.prototype.valueToPrc=function(a,b){var c;if(this.settings.heterogeneity&&this.settings.heterogeneity.length>0)for(var d=this.settings.heterogeneity,e=0,f=this.settings.from,g=0;g<=d.length;g++){var h;h=d[g]?d[g].split("/"):[100,this.settings.to],a>=f&&a<=h[1]&&(c=b.limits(e+(a-f)*(h[0]-e)/(h[1]-f))),e=h[0],f=h[1]}else c=b.limits(100*(a-this.settings.from)/this.settings.interval);return c},c.prototype.round=function(a){return a=Math.round(a/this.settings.step)*this.settings.step,a=this.settings.round?Math.round(a*Math.pow(10,this.settings.round))/Math.pow(10,this.settings.round):Math.round(a)},d.prototype.oninit=function(){},d.prototype.events=function(){},d.prototype.onmousedown=function(){this.ptr.css({position:"absolute"})},d.prototype.onmousemove=function(a,b,c){this.ptr.css({left:b,top:c})},d.prototype.onmouseup=function(){},d.prototype.isDefault={drag:!1,clicked:!1,toclick:!0,mouseup:!1},d.prototype._init=function(){if(arguments.length>0){this.ptr=a(arguments[0]),this.outer=a(".draggable-outer"),this.is={},a.extend(this.is,this.isDefault);var b=this.ptr.offset();this.d={left:b.left,top:b.top,width:this.ptr.width(),height:this.ptr.height()},this.oninit.apply(this,arguments),this._events()}},d.prototype._getPageCoords=function(a){return a.targetTouches&&a.targetTouches[0]?{x:a.targetTouches[0].pageX,y:a.targetTouches[0].pageY}:{x:a.pageX,y:a.pageY}},d.prototype._bindEvent=function(a,b,c){this.supportTouches_?a.get(0).addEventListener(this.events_[b],c,!1):a.bind(this.events_[b],c)},d.prototype._events=function(){var b=this;this.supportTouches_="ontouchend"in document,this.events_={click:this.supportTouches_?"touchstart":"click",down:this.supportTouches_?"touchstart":"mousedown",move:this.supportTouches_?"touchmove":"mousemove",up:this.supportTouches_?"touchend":"mouseup"},this._bindEvent(a(document),"move",function(a){b.is.drag&&(a.stopPropagation(),a.preventDefault(),b._mousemove(a))}),this._bindEvent(a(document),"down",function(a){b.is.drag&&(a.stopPropagation(),a.preventDefault())}),this._bindEvent(a(document),"up",function(a){b._mouseup(a)}),this._bindEvent(this.ptr,"down",function(a){return b._mousedown(a),!1}),this._bindEvent(this.ptr,"up",function(a){b._mouseup(a)}),this.ptr.find("a").click(function(){return b.is.clicked=!0,b.is.toclick?void 0:(b.is.toclick=!0,!1)}).mousedown(function(a){return b._mousedown(a),!1}),this.events()},d.prototype._mousedown=function(b){this.is.drag=!0,this.is.clicked=!1,this.is.mouseup=!1;var c=this.ptr.offset(),d=this._getPageCoords(b);this.cx=d.x-c.left,this.cy=d.y-c.top,a.extend(this.d,{left:c.left,top:c.top,width:this.ptr.width(),height:this.ptr.height()}),this.outer&&this.outer.get(0)&&this.outer.css({height:Math.max(this.outer.height(),a(document.body).height()),overflow:"hidden"}),this.onmousedown(b)},d.prototype._mousemove=function(a){this.is.toclick=!1;var b=this._getPageCoords(a);this.onmousemove(a,b.x-this.cx,b.y-this.cy)},d.prototype._mouseup=function(b){this.is.drag&&(this.is.drag=!1,this.outer&&this.outer.get(0)&&(this.outer.css(a.browser.mozilla?{overflow:"hidden"}:{overflow:"visible"}),this.outer.css(a.browser.msie&&"6.0"==a.browser.version?{height:"100%"}:{height:"auto"})),this.onmouseup(b))},window.Draggable=d,e.prototype=new d,e.prototype.oninit=function(a,b,c){this.uid=b,this.parent=c,this.value={},this.settings=this.parent.settings},e.prototype.onmousedown=function(){this._parent={offset:this.parent.domNode.offset(),width:this.parent.domNode.width()},this.ptr.addClass("jslider-pointer-hover"),this.setIndexOver()},e.prototype.onmousemove=function(a){var b=this._getPageCoords(a);this._set(this.calc(b.x))},e.prototype.onmouseup=function(){this.parent.settings.callback&&a.isFunction(this.parent.settings.callback)&&this.parent.settings.callback.call(this.parent,this.parent.getValue()),this.ptr.removeClass("jslider-pointer-hover")},e.prototype.setIndexOver=function(){this.parent.setPointersIndex(1),this.index(2)},e.prototype.index=function(a){this.ptr.css({zIndex:a})},e.prototype.limits=function(a){return this.parent.limits(a,this)},e.prototype.calc=function(a){var b=this.limits(100*(a-this._parent.offset.left)/this._parent.width);return b},e.prototype.set=function(a,b){this.value.origin=this.parent.round(a),this._set(this.parent.valueToPrc(a,this),b)},e.prototype._set=function(a,b){b||(this.value.origin=this.parent.prcToValue(a)),this.value.prc=a,this.ptr.css({left:a+"%"}),this.parent.redraw(this)}}(jQuery)}(angular);